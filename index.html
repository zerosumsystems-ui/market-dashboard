<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Market Command Center</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--bg-0:#060a11;--bg-1:#0b1019;--bg-2:#111827;--bg-3:#1a2540;--border:#1b2742;--border-l:#263657;--t1:#eaf0fb;--t2:#8fa3c4;--t3:#4f6484;--grn:#10b981;--grn2:#34d399;--red:#ef4444;--red2:#f87171;--red-bg:rgba(239,68,68,.12);--ylw:#eab308;--ylw2:#fde047;--cyn:#06b6d4;--cyn2:#67e8f9;--cyn-bg:rgba(6,182,212,.08);--prp:#a78bfa}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg-0);color:var(--t1);font-family:'Outfit',sans-serif;overflow-x:hidden}
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:9999;opacity:.35;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.02'/%3E%3C/svg%3E")}
.orb{position:fixed;border-radius:50%;filter:blur(130px);opacity:.05;pointer-events:none;z-index:0}
.orb.a{width:700px;height:700px;background:var(--grn);top:-250px;right:-150px}
.orb.b{width:500px;height:500px;background:var(--red);bottom:-200px;left:-100px}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:.7rem 2rem;background:var(--bg-1);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:50}
.brand{font-family:'JetBrains Mono',monospace;font-weight:800;font-size:1rem;background:linear-gradient(135deg,var(--cyn),var(--prp));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.topbar-r{display:flex;align-items:center;gap:.6rem;font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--t3)}
.live-dot{width:7px;height:7px;border-radius:50%;background:var(--grn);animation:pulse 2s ease-in-out infinite}
@keyframes pulse{0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(16,185,129,.5)}50%{opacity:.5;box-shadow:0 0 0 5px rgba(16,185,129,0)}}
.btn{background:var(--cyn-bg);border:1px solid rgba(6,182,212,.2);color:var(--cyn);font-family:'JetBrains Mono',monospace;font-size:.58rem;padding:.3rem .65rem;border-radius:5px;cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.06em}
.btn:hover{background:rgba(6,182,212,.2)}.btn.ld{opacity:.5;pointer-events:none}
.tabs{display:flex;background:var(--bg-1);border-bottom:1px solid var(--border);padding:0 2rem;overflow-x:auto}
.tab{padding:.65rem 1.2rem;font-family:'JetBrains Mono',monospace;font-size:.66rem;font-weight:600;color:var(--t3);cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;text-transform:uppercase;letter-spacing:.07em;white-space:nowrap;user-select:none}
.tab:hover{color:var(--t2)}.tab.active{color:var(--cyn);border-bottom-color:var(--cyn)}
.panel{display:none;padding:1.5rem 2rem 3rem;position:relative;z-index:1}
.panel.active{display:block;animation:fadeUp .4s ease}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.sec{display:flex;align-items:center;gap:1rem;margin:1.8rem 0 1rem}
.sec h2{font-family:'JetBrains Mono',monospace;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--t3);white-space:nowrap}
.sec .line{flex:1;height:1px;background:var(--border)}
.sec .badge{font-family:'JetBrains Mono',monospace;font-size:.55rem;padding:.2rem .5rem;border-radius:4px;background:var(--cyn-bg);color:var(--cyn);border:1px solid rgba(6,182,212,.15)}
.idx-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:1rem}
.idx-card{background:var(--bg-2);border:1px solid var(--border);border-radius:10px;padding:1.1rem 1.3rem;position:relative;overflow:hidden;transition:border-color .2s}
.idx-card:hover{border-color:var(--border-l)}
.idx-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.idx-card.up::before{background:linear-gradient(90deg,var(--grn),transparent)}
.idx-card.dn::before{background:linear-gradient(90deg,var(--red),transparent)}
.idx-lbl{font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--t3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:.25rem}
.idx-row{display:flex;align-items:baseline;gap:.7rem;flex-wrap:wrap}
.idx-px{font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700}
.idx-chg{font-family:'JetBrains Mono',monospace;font-size:.78rem;font-weight:600}
.idx-chg.up{color:var(--grn2)}.idx-chg.dn{color:var(--red2)}
.idx-bar{margin-top:.5rem;height:3px;background:var(--bg-3);border-radius:2px;overflow:hidden}
.idx-bar-fill{height:100%;border-radius:2px;transition:width 1.2s ease}
.idx-sub{font-family:'JetBrains Mono',monospace;font-size:.56rem;color:var(--t3);margin-top:.35rem}
.stat-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem}
.sc{background:var(--bg-2);border:1px solid var(--border);border-radius:10px;padding:1rem 1.2rem;position:relative;overflow:hidden}
.sc::before{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.sc.g::before{background:linear-gradient(90deg,var(--grn),transparent)}
.sc.r::before{background:linear-gradient(90deg,var(--red),transparent)}
.sc.y::before{background:linear-gradient(90deg,var(--ylw),transparent)}
.sc.c::before{background:linear-gradient(90deg,var(--cyn),transparent)}
.sc-lbl{font-family:'JetBrains Mono',monospace;font-size:.56rem;color:var(--t3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:.3rem}
.sc-val{font-family:'JetBrains Mono',monospace;font-size:1.3rem;font-weight:700}
.sc-val.g{color:var(--grn2)}.sc-val.r{color:var(--red2)}.sc-val.y{color:var(--ylw2)}
.sc-sub{font-family:'JetBrains Mono',monospace;font-size:.56rem;color:var(--t3);margin-top:.15rem}
.dist-bar{display:flex;height:34px;border-radius:6px;overflow:hidden;margin:.8rem 0;border:1px solid var(--border)}
.dist-bar div{display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-size:.55rem;font-weight:600;color:#fff;transition:width 1s ease;min-width:0;overflow:hidden}
.tw{border-radius:10px;border:1px solid var(--border);background:var(--bg-1);overflow-x:auto;box-shadow:0 2px 16px rgba(0,0,0,.2)}
.tw table{width:100%;border-collapse:collapse;font-family:'JetBrains Mono',monospace;font-size:.7rem;min-width:700px}
.tw th{background:var(--bg-2);color:var(--t3);font-size:.56rem;font-weight:600;letter-spacing:.05em;text-transform:uppercase;padding:.6rem .55rem;text-align:right;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:5;white-space:nowrap}
.tw th:first-child{text-align:left;padding-left:1rem}
.tw td{padding:.45rem .55rem;text-align:right;font-weight:500;color:var(--t1);border-bottom:1px solid rgba(27,39,66,.4);white-space:nowrap}
.tw td:first-child{text-align:left;padding-left:1rem;color:var(--cyn2);font-weight:700}
.tw tbody tr:hover{background:rgba(6,182,212,.04)}
.up-c{color:var(--grn2)}.dn-c{color:var(--red2)}
.hsg{background:rgba(16,185,129,.22);color:var(--grn2)}.hg{background:rgba(52,211,153,.1);color:#86efac}
.hy{background:rgba(234,179,8,.14);color:var(--ylw2)}.hr{background:rgba(252,165,165,.12);color:#fca5a5}
.hsr{background:rgba(239,68,68,.2);color:var(--red2)}
.br{display:inline-block;padding:.12rem .32rem;border-radius:4px;font-weight:700;font-size:.68rem}
.br.bull{background:rgba(16,185,129,.18);color:var(--grn2)}
.br.bear{background:rgba(239,68,68,.18);color:var(--red2)}
.br.neut{background:rgba(234,179,8,.12);color:var(--ylw2)}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
canvas{width:100%!important;height:140px!important}
.cc{background:var(--bg-2);border:1px solid var(--border);border-radius:10px;padding:1.2rem}
.cc h3{font-family:'JetBrains Mono',monospace;font-size:.65rem;text-transform:uppercase;letter-spacing:.08em;color:var(--t3);margin-bottom:.7rem}
.shimmer{background:linear-gradient(90deg,var(--bg-2) 25%,var(--bg-3) 50%,var(--bg-2) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:6px;min-height:60px}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
.err{background:var(--red-bg);border:1px solid rgba(239,68,68,.2);border-radius:8px;padding:1rem;font-family:'JetBrains Mono',monospace;font-size:.72rem;color:var(--red2);margin:1rem 0}
.footer{text-align:center;padding:2rem;font-size:.6rem;color:var(--t3);font-family:'JetBrains Mono',monospace;border-top:1px solid var(--border);margin-top:2rem}
@media(max-width:900px){.g2{grid-template-columns:1fr}.topbar,.tabs,.panel{padding-left:1rem;padding-right:1rem}.idx-grid{grid-template-columns:1fr 1fr}}
@media(max-width:600px){.idx-grid{grid-template-columns:1fr}}
.scr-filters{background:var(--bg-2);border:1px solid var(--border);border-radius:10px;padding:1rem 1.2rem;margin-bottom:1rem}
.scr-filters-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.8rem;margin-top:.8rem}
.scr-fg{display:flex;flex-direction:column;gap:.25rem}
.scr-fg label{font-family:"JetBrains Mono",monospace;font-size:.55rem;color:var(--t3);text-transform:uppercase;letter-spacing:.06em}
.scr-fg select,.scr-fg input{background:var(--bg-3);border:1px solid var(--border);border-radius:5px;padding:.4rem .5rem;color:var(--t1);font-family:"JetBrains Mono",monospace;font-size:.68rem;outline:none}
.scr-fg select:focus,.scr-fg input:focus{border-color:var(--cyn)}
.scr-actions{display:flex;gap:.6rem;margin-top:.8rem;align-items:center}
.scr-btn{background:var(--cyn-bg);border:1px solid rgba(6,182,212,.2);color:var(--cyn);font-family:"JetBrains Mono",monospace;font-size:.6rem;padding:.4rem .8rem;border-radius:5px;cursor:pointer;text-transform:uppercase;letter-spacing:.06em}
.scr-btn:hover{background:rgba(6,182,212,.2)}
.scr-btn.rst{background:var(--red-bg);border-color:rgba(239,68,68,.2);color:var(--red2)}
.scr-count{font-family:"JetBrains Mono",monospace;font-size:.58rem;color:var(--t3);margin-left:auto}
.scr-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem}
.scr-card{background:var(--bg-2);border:1px solid var(--border);border-radius:8px;padding:.7rem .8rem;overflow:hidden;transition:border-color .2s}
.scr-card:hover{border-color:var(--border-l)}
.scr-head{display:flex;justify-content:space-between;align-items:baseline}
.scr-tk{font-family:"JetBrains Mono",monospace;font-size:.78rem;font-weight:700;color:var(--cyn2)}
.scr-px{font-family:"JetBrains Mono",monospace;font-size:.72rem;font-weight:600;color:var(--t1)}
.scr-meta{display:flex;justify-content:space-between;font-family:"JetBrains Mono",monospace;font-size:.58rem;margin:.2rem 0 .4rem}
.scr-vol{color:var(--t3)}
.scr-canvas{width:100%!important;height:160px!important;display:block}
@media(max-width:900px){.scr-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.scr-grid{grid-template-columns:1fr}}
.scr-filters{background:var(--bg-2);border:1px solid var(--border);border-radius:10px;padding:1rem 1.2rem;margin-bottom:1rem}
.scr-filters-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.8rem;margin-top:.8rem}
.scr-fg{display:flex;flex-direction:column;gap:.25rem}
.scr-fg label{font-family:"JetBrains Mono",monospace;font-size:.55rem;color:var(--t3);text-transform:uppercase;letter-spacing:.06em}
.scr-fg select,.scr-fg input{background:var(--bg-3);border:1px solid var(--border);border-radius:5px;padding:.4rem .5rem;color:var(--t1);font-family:"JetBrains Mono",monospace;font-size:.68rem;outline:none}
.scr-fg select:focus,.scr-fg input:focus{border-color:var(--cyn)}
.scr-actions{display:flex;gap:.6rem;margin-top:.8rem;align-items:center}
.scr-btn{background:var(--cyn-bg);border:1px solid rgba(6,182,212,.2);color:var(--cyn);font-family:"JetBrains Mono",monospace;font-size:.6rem;padding:.4rem .8rem;border-radius:5px;cursor:pointer;text-transform:uppercase;letter-spacing:.06em}
.scr-btn:hover{background:rgba(6,182,212,.2)}
.scr-btn.rst{background:var(--red-bg);border-color:rgba(239,68,68,.2);color:var(--red2)}
.scr-count{font-family:"JetBrains Mono",monospace;font-size:.58rem;color:var(--t3);margin-left:auto}
.scr-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem}
.scr-card{background:var(--bg-2);border:1px solid var(--border);border-radius:8px;padding:.7rem .8rem;overflow:hidden;transition:border-color .2s}
.scr-card:hover{border-color:var(--border-l)}
.scr-head{display:flex;justify-content:space-between;align-items:baseline}
.scr-tk{font-family:"JetBrains Mono",monospace;font-size:.78rem;font-weight:700;color:var(--cyn2)}
.scr-px{font-family:"JetBrains Mono",monospace;font-size:.72rem;font-weight:600;color:var(--t1)}
.scr-meta{display:flex;justify-content:space-between;font-family:"JetBrains Mono",monospace;font-size:.58rem;margin:.2rem 0 .4rem}
.scr-vol{color:var(--t3)}
.scr-canvas{width:100%!important;height:160px!important;display:block}
@media(max-width:900px){.scr-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.scr-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="orb a"></div><div class="orb b"></div>
<div class="topbar">
  <div class="brand">MKT COMMAND</div>
  <div class="topbar-r"><div class="live-dot"></div><span id="clock">POLYGON.IO</span>
  <button class="btn" id="refBtn" onclick="refreshAll()">REFRESH</button></div>
</div>
<div class="tabs">
  <div class="tab active" data-tab="overview">Overview</div>
  <div class="tab" data-tab="breadth">Market Breadth</div>
  <div class="tab" data-tab="movers">Movers</div>
  <div class="tab" data-tab="screener">Screener</div>
</div>
<div class="panel active" id="panel-overview">
  <div class="sec"><h2>Index Proxies</h2><div class="line"></div><div class="badge">ETF SNAPSHOT</div></div>
  <div class="idx-grid" id="idxCards"><div class="shimmer"></div><div class="shimmer"></div><div class="shimmer"></div><div class="shimmer"></div></div>
  <div class="sec"><h2>Today's Breadth</h2><div class="line"></div><div class="badge">FULL MARKET</div></div>
  <div class="stat-row" id="bStats"><div class="shimmer"></div><div class="shimmer"></div><div class="shimmer"></div><div class="shimmer"></div></div>
  <div class="sec"><h2>Advance / Decline Distribution</h2><div class="line"></div></div>
  <div id="distBar"><div class="shimmer" style="min-height:34px"></div></div>
  <div id="distLeg"></div>
  <div class="sec"><h2>30-Day Price History</h2><div class="line"></div><div class="badge">SPY / QQQ</div></div>
  <div class="g2">
    <div class="cc"><h3>SPY - S&amp;P 500</h3><canvas id="ch-SPY"></canvas></div>
    <div class="cc"><h3>QQQ - NASDAQ 100</h3><canvas id="ch-QQQ"></canvas></div>
  </div>
</div>
<div class="panel" id="panel-breadth">
  <div class="sec"><h2>Live Breadth</h2><div class="line"></div><div class="badge">FROM SNAPSHOT</div></div>
  <div class="stat-row" id="bStatsFull"><div class="shimmer"></div></div>
  <div class="sec"><h2>Historical Breadth (ZeroSumSystems)</h2><div class="line"></div></div>
  <div class="tw"><table>
    <thead><tr><th>Date</th><th>Up 4%+</th><th>Dn 4%+</th><th>5d Ratio</th><th>10d Ratio</th><th>Up25%Q</th><th>Dn25%Q</th><th>Up25%M</th><th>Dn25%M</th><th>Up50%M</th><th>Dn50%M</th><th>Up13%34d</th><th>Dn13%34d</th><th>Univ</th></tr></thead>
    <tbody id="seedTbl"></tbody>
  </table></div>
</div>
<div class="panel" id="panel-movers">
  <div class="sec"><h2>Top Gainers</h2><div class="line"></div><div class="badge">TODAY</div></div>
  <div class="tw"><table><thead><tr><th>Ticker</th><th>Price</th><th>Change</th><th>% Change</th><th>Volume</th></tr></thead>
  <tbody id="gainTbl"><tr><td colspan="5" style="text-align:center;padding:2rem"><div class="shimmer" style="display:inline-block;width:200px;min-height:20px"></div></td></tr></tbody></table></div>
  <div class="sec"><h2>Top Losers</h2><div class="line"></div></div>
  <div class="tw"><table><thead><tr><th>Ticker</th><th>Price</th><th>Change</th><th>% Change</th><th>Volume</th></tr></thead>
  <tbody id="loseTbl"><tr><td colspan="5" style="text-align:center;padding:2rem"><div class="shimmer" style="display:inline-block;width:200px;min-height:20px"></div></td></tr></tbody></table></div>
</div>
<div class="panel" id="panel-screener">
  <div class="sec"><h2>Stock Screener</h2><div class="line"></div><button class="btn" id="scrFilterToggle">HIDE FILTERS</button></div>
  <div class="scr-filters" id="scrFilterPanel">
    <div class="scr-filters-grid">
      <div class="scr-fg"><label>Min Price ($)</label><input type="number" id="fMinPrice" value="2" placeholder="2"></div>
      <div class="scr-fg"><label>Max Price ($)</label><input type="number" id="fMaxPrice" value="" placeholder="Any"></div>
      <div class="scr-fg"><label>Min Volume</label><input type="number" id="fMinVol" value="50000" placeholder="50000"></div>
      <div class="scr-fg"><label>Max Volume</label><input type="number" id="fMaxVol" value="" placeholder="Any"></div>
      <div class="scr-fg"><label>Min % Change</label><input type="number" id="fMinChg" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Max % Change</label><input type="number" id="fMaxChg" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Min Gap %</label><input type="number" id="fMinGap" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Max Gap %</label><input type="number" id="fMaxGap" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Min Range %</label><input type="number" id="fMinRange" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Max Range %</label><input type="number" id="fMaxRange" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Min Rel Volume (x)</label><input type="number" id="fMinRelVol" value="" placeholder="Any" step="0.1"></div>
      <div class="scr-fg"><label>Min Open ($)</label><input type="number" id="fMinOpen" value="" placeholder="Any"></div>
      <div class="scr-fg"><label>Max Open ($)</label><input type="number" id="fMaxOpen" value="" placeholder="Any"></div>
      <div class="scr-fg"><label>Sort By</label><select id="fSort">
        <option value="changeDesc">% Change (High-Low)</option>
        <option value="changeAsc">% Change (Low-High)</option>
        <option value="volumeDesc">Volume (High-Low)</option>
        <option value="volumeAsc">Volume (Low-High)</option>
        <option value="priceDesc">Price (High-Low)</option>
        <option value="priceAsc">Price (Low-High)</option>
        <option value="gapDesc">Gap % (High-Low)</option>
        <option value="rangeDesc">Range % (High-Low)</option>
        <option value="relVolDesc">Rel Volume (High-Low)</option>
      </select></div>
    </div>
    <div class="scr-actions">
